<div class="Box-sc-g0xbh4-0 bJMeLZ js-snippet-clipboard-copy-unpositioned" data-hpc="true"><article class="markdown-body entry-content container-lg" itemprop="text"><div class="markdown-heading" dir="auto"><h1 tabindex="-1" class="heading-element" dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">开源 GPU</font></font></h1><a id="user-content-opensource-gpu" class="anchor" aria-label="永久链接：开源 GPU" href="#opensource-gpu"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">构建一个开源 GPU，针对 ASIC 流片，用于</font></font><a href="https://en.wikipedia.org/wiki/Machine_learning" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">机器学习</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  (“ML”)。希望它能够与</font></font><a href="https://pytorch.org" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PyTorch</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">深度学习框架一起使用。</font></font></p>
<div class="markdown-heading" dir="auto"><h1 tabindex="-1" class="heading-element" dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">想象</font></font></h1><a id="user-content-vision" class="anchor" aria-label="永久链接： 愿景" href="#vision"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">创建用于机器学习的开源 GPU。</font></font></p>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我实际上并不打算自己将其录制下来，但我打算尽我所能来验证录制是否可以正常工作，计时是否正常等等。</font></font></p>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">打算实现一个与</font><a href="https://pytorch.org" rel="nofollow"><font style="vertical-align: inherit;">pytorch</font></a><font style="vertical-align: inherit;">机器学习框架</font><font style="vertical-align: inherit;">兼容的</font></font><a href="https://github.com/ROCm-Developer-Tools/HIP"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HIP</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> API。开放提供其他 API，例如</font><a href="https://www.khronos.org/sycl/" rel="nofollow"><font style="vertical-align: inherit;">SYCL</font></a><font style="vertical-align: inherit;">或</font><a href="https://developer.nvidia.com/cuda-toolkit" rel="nofollow"><font style="vertical-align: inherit;">NVIDIA® CUDA™</font></a><font style="vertical-align: inherit;">。</font></font><a href="https://pytorch.org" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><a href="https://www.khronos.org/sycl/" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><a href="https://developer.nvidia.com/cuda-toolkit" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font></p>
<p dir="auto"><font style="vertical-align: inherit;"></font><a href="https://riscv.org/technical/specifications/" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">内部 GPU 核心 ISA 与RISC-V</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ISA</font><font style="vertical-align: inherit;">松散兼容。</font><font style="vertical-align: inherit;">当 RISC-V 与 GPU 设置设计发生冲突时，我们就与 RISC-V 决裂。</font></font></p>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">打算让核心非常专注于机器学习。例如，始终</font></font><a href="https://en.wikipedia.org/wiki/Bfloat16_floating-point_format" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">采用大脑浮点</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（“BF16”），以保持核心芯片面积较低。这应该可以保持每核成本较低。同样，打算仅实现对 ML 至关重要的少数浮点运算，例如</font></font><code>exp</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><code>log</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><code>tanh</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><code>sqrt</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
<div class="markdown-heading" dir="auto"><h1 tabindex="-1" class="heading-element" dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">建筑学</font></font></h1><a id="user-content-architecture" class="anchor" aria-label="永久链接：建筑" href="#architecture"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">大图景：</font></font></p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/hughperkins/VeriGPU/blob/main/docs/img/overall.png"><img src="/hughperkins/VeriGPU/raw/main/docs/img/overall.png" alt="大局观" style="max-width: 100%;"></a></p>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GPU 芯片架构：</font></font></p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/hughperkins/VeriGPU/blob/main/docs/img/gpu_die.png"><img src="/hughperkins/VeriGPU/raw/main/docs/img/gpu_die.png" alt="GPU 芯片架构" style="max-width: 100%;"></a></p>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">单核：</font></font></p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/hughperkins/VeriGPU/blob/main/docs/img/core.png"><img src="/hughperkins/VeriGPU/raw/main/docs/img/core.png" alt="单核" style="max-width: 100%;"></a></p>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">单源编译和运行时</font></font></p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/hughperkins/VeriGPU/blob/main/docs/img/endtoend.png"><img src="/hughperkins/VeriGPU/raw/main/docs/img/endtoend.png" alt="端到端架构" style="max-width: 100%;"></a></p>
<div class="markdown-heading" dir="auto"><h1 tabindex="-1" class="heading-element" dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">模拟</font></font></h1><a id="user-content-simulation" class="anchor" aria-label="永久链接：模拟" href="#simulation"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>


<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">单一源 C++</font></font></h2><a id="user-content-single-source-c" class="anchor" aria-label="永久链接：单一源 C++" href="#single-source-c"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">单一源 C++：</font></font></p>
<ul dir="auto">
<li><a href="/hughperkins/VeriGPU/blob/main/examples/cpp_single_source/sum_ints.cpp"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">示例/cpp_single_source/sum_ints.cpp</font></font></a></li>
</ul>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/hughperkins/VeriGPU/blob/main/docs/img/single_source_code.png"><img src="/hughperkins/VeriGPU/raw/main/docs/img/single_source_code.png" alt="单一源 C++" style="max-width: 100%;"></a></p>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">编译 GPU 和运行时：</font></font></p>
<ul dir="auto">
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CMakeLists.txt：</font></font><a href="/hughperkins/VeriGPU/blob/main/src/gpu_runtime/CMakeLists.txt"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">src/gpu_runtime/CMakeLists.txt</font></font></a></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GPU运行时：</font></font><a href="/hughperkins/VeriGPU/blob/main/src/gpu_runtime/gpu_runtime.cpp"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">src/gpu_runtime/gpu_runtime.cpp</font></font></a></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GPU控制器：</font></font><a href="/hughperkins/VeriGPU/blob/main/src/gpu_controller.sv"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">src/gpu_controller.sv</font></font></a></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">单 GPU RISC-V 内核：</font></font><a href="/hughperkins/VeriGPU/blob/main/src/core.sv"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">src/core.sv</font></font></a></li>
</ul>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/hughperkins/VeriGPU/blob/main/docs/img/compile_gpu_and_runtime.png"><img src="/hughperkins/VeriGPU/raw/main/docs/img/compile_gpu_and_runtime.png" alt="编译GPU和运行时" style="max-width: 100%;"></a></p>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">编译单源 C++，然后运行：</font></font></p>
<ul dir="auto">
<li><a href="/hughperkins/VeriGPU/blob/main/examples/cpp_single_source/run.sh"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">示例/cpp_single_source/run.sh sum_ints</font></font></a></li>
</ul>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/hughperkins/VeriGPU/blob/main/docs/img/single_source_run.png"><img src="/hughperkins/VeriGPU/raw/main/docs/img/single_source_run.png" alt="运行单源示例" style="max-width: 100%;"></a></p>
<div class="markdown-heading" dir="auto"><h1 tabindex="-1" class="heading-element" dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">规划</font></font></h1><a id="user-content-planning" class="anchor" aria-label="永久链接：规划" href="#planning"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我们想朝什么方向发展？什么已经起作用了？看：</font></font></p>
<ul dir="auto">
<li><a href="/hughperkins/VeriGPU/blob/main/docs/planning.md"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文档/planning.md</font></font></a></li>
</ul>
<div class="markdown-heading" dir="auto"><h1 tabindex="-1" class="heading-element" dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">技术细节</font></font></h1><a id="user-content-tech-details" class="anchor" aria-label="永久链接：技术细节" href="#tech-details"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我们的汇编语言实现和进展。 GPU内存、寄存器等设计。看：</font></font></p>
<ul dir="auto">
<li><a href="/hughperkins/VeriGPU/blob/main/docs/tech_details.md"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文档/tech_details.md</font></font></a></li>
</ul>
<div class="markdown-heading" dir="auto"><h1 tabindex="-1" class="heading-element" dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">确认</font></font></h1><a id="user-content-verification" class="anchor" aria-label="永久链接：验证" href="#verification"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果我们想要流片，我们需要可靠的验证。阅读更多内容：</font></font></p>
<ul dir="auto">
<li><a href="/hughperkins/VeriGPU/blob/main/docs/verification.md"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文档/验证.md</font></font></a></li>
</ul>
<div class="markdown-heading" dir="auto"><h1 tabindex="-1" class="heading-element" dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">指标</font></font></h1><a id="user-content-metrics" class="anchor" aria-label="永久链接：指标" href="#metrics"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我们希望 GPU 能够快速运行，并使用最小的芯片面积。请阅读我们如何测量时间和面积：</font></font></p>
<ul dir="auto">
<li><a href="/hughperkins/VeriGPU/blob/main/docs/metrics.md"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文档/metrics.md</font></font></a></li>
</ul>



</article></div>
